<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doctor Dashboard ‚Äì AfterHeal</title>
    <meta name="description" content="Manage patients, prescriptions, documents, and monitor treatment adherence.">
    <link rel="stylesheet" href="styles/global.css">
    <link rel="stylesheet" href="styles/dashboard.css">
    <style>
        /* ‚îÄ‚îÄ Doctor-specific enhancements ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */

        /* Patient row hover + selected state */
        .selectable-patient {
            transition: background 0.18s, box-shadow 0.18s;
        }

        .selectable-patient:hover {
            background: var(--primary-light, #EBF5FF);
        }

        .patient-selected {
            background: var(--primary-light, #EBF5FF) !important;
            box-shadow: inset 3px 0 0 var(--primary);
        }

        /* Prompt banners (select-patient prompts) */
        .select-patient-prompt {
            display: flex;
            align-items: center;
            gap: 14px;
            background: linear-gradient(135deg, #EBF5FF, #F0F9FF);
            border: 1.5px dashed var(--primary);
            border-radius: var(--radius);
            padding: 24px 28px;
            margin-bottom: 24px;
            color: var(--text-secondary);
        }

        .select-patient-prompt .prompt-icon {
            font-size: 2.4rem;
            flex-shrink: 0;
        }

        .select-patient-prompt h3 {
            margin: 0 0 4px;
            color: var(--primary);
            font-size: 1rem;
        }

        .select-patient-prompt p {
            margin: 0;
            font-size: 0.85rem;
        }

        /* Sub-tabs inside a section */
        .section-subtabs {
            display: flex;
            gap: 4px;
            border-bottom: 2px solid var(--border);
            margin-bottom: 20px;
        }

        .section-subtab {
            padding: 8px 18px;
            font-size: 0.85rem;
            font-weight: 600;
            border: none;
            background: transparent;
            cursor: pointer;
            border-radius: var(--radius-sm) var(--radius-sm) 0 0;
            color: var(--text-muted);
            transition: all 0.18s;
        }

        .section-subtab.active {
            color: var(--primary);
            border-bottom: 2.5px solid var(--primary);
            background: var(--surface2);
        }

        .section-subtab:hover:not(.active) {
            background: var(--surface2);
        }

        .subtab-panel {
            display: none;
        }

        .subtab-panel.active {
            display: block;
        }

        /* Document grid */
        .doc-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 14px;
        }

        .doc-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 18px;
            display: flex;
            gap: 14px;
            align-items: flex-start;
            transition: box-shadow 0.18s, transform 0.18s;
        }

        .doc-card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .doc-icon {
            width: 46px;
            height: 46px;
            border-radius: var(--radius-sm);
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
        }

        .doc-info {
            flex: 1;
            min-width: 0;
        }

        .doc-name {
            font-weight: 700;
            font-size: 0.9rem;
            margin-bottom: 6px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .doc-meta {
            display: flex;
            gap: 8px;
            align-items: center;
            flex-wrap: wrap;
            margin-bottom: 6px;
        }

        .doc-notes {
            font-size: 0.78rem;
            color: var(--text-muted);
            line-height: 1.45;
            border-top: 1px solid var(--border);
            padding-top: 6px;
            margin-top: 6px;
        }

        .doc-actions {
            display: flex;
            flex-direction: column;
            gap: 6px;
            flex-shrink: 0;
        }

        /* 7-day adherence trend cells */
        .trend-cell {
            width: 32px;
            height: 22px;
            border-radius: 4px;
        }

        .trend-taken {
            background: var(--good, #00B894);
        }

        .trend-partial {
            background: var(--moderate, #F0A500);
        }

        .trend-missed {
            background: var(--poor, #E74C3C);
        }

        .trend-future {
            background: var(--border);
        }

        .trend-none {
            background: transparent;
            border: 1px dashed var(--border);
        }

        /* Adherence per-patient panel */
        .adh-big-num {
            font-size: 3.5rem;
            font-weight: 900;
            line-height: 1;
        }

        .adh-overview {
            display: flex;
            gap: 24px;
            align-items: center;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .adh-overview .adh-details {
            flex: 1;
            min-width: 200px;
        }

        /* Selected patient banner (inside Rx/Adherence sections) */
        .patient-scope-header {
            display: flex;
            align-items: center;
            gap: 12px;
            background: var(--surface2);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 12px 16px;
            margin-bottom: 20px;
        }

        .patient-scope-header .scope-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--doctor-color, #0A81D1);
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.1rem;
            flex-shrink: 0;
        }

        .patient-scope-header .scope-meta {
            flex: 1;
        }

        .patient-scope-header .scope-name {
            font-weight: 700;
            font-size: 0.95rem;
        }

        .patient-scope-header .scope-label {
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        /* Section divider */
        .section-divider {
            border: none;
            border-top: 1px solid var(--border);
            margin: 20px 0;
        }

        /* Trend legend */
        .trend-legend {
            display: flex;
            gap: 14px;
            flex-wrap: wrap;
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: 12px;
        }

        .trend-legend span {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .trend-sample {
            width: 14px;
            height: 14px;
            border-radius: 3px;
            display: inline-block;
        }
    </style>
</head>

<body class="theme-doctor">
    <div class="sidebar-overlay" id="sidebar-overlay"></div>

    <div class="dashboard-shell">
        <!-- ‚ïê‚ïê SIDEBAR ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-logo">
                <div class="sidebar-logo-icon theme-doctor">üè•</div>
                <div>
                    <div class="sidebar-logo-text">AfterHeal</div>
                    <div class="sidebar-logo-sub">Doctor Portal</div>
                </div>
            </div>
            <div class="sidebar-user">
                <div class="sidebar-avatar" id="sidebar-avatar" style="background:var(--doctor-color)">D</div>
                <div>
                    <div class="sidebar-user-name" id="sidebar-user-name">Doctor</div>
                    <div class="sidebar-user-role" id="sidebar-user-role">Doctor</div>
                </div>
            </div>
            <nav class="sidebar-nav">
                <div class="nav-group-label">Management</div>
                <button class="nav-link active" data-section="section-overview">
                    <span class="nav-icon">üè†</span> Overview
                </button>
                <button class="nav-link" data-section="section-patients">
                    <span class="nav-icon">üë§</span> My Patients
                </button>
                <button class="nav-link" data-section="section-prescriptions">
                    <span class="nav-icon">üíä</span> Prescriptions
                </button>
                <button class="nav-link" data-section="section-adherence">
                    <span class="nav-icon">üìä</span> Adherence Monitor
                </button>
                <button class="nav-link" data-section="section-appointments">
                    <span class="nav-icon">üìÖ</span> Schedule Appointment
                </button>
            </nav>
            <div class="sidebar-footer">
                <button class="logout-btn"><span>üö™</span> Logout</button>
            </div>
        </aside>

        <!-- ‚ïê‚ïê MAIN CONTENT ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
        <div class="main-content">
            <!-- Topbar -->
            <header class="topbar">
                <div class="topbar-left">
                    <button class="hamburger-btn" id="hamburger-btn" aria-label="Toggle menu">‚ò∞</button>
                    <div>
                        <div class="topbar-title" id="topbar-greeting">Welcome üëã</div>
                        <div class="topbar-subtitle">Doctor Dashboard</div>
                    </div>
                </div>
                <div class="topbar-right">
                    <div class="topbar-date" id="topbar-date"></div>
                    <button class="btn btn-outline btn-sm logout-btn">Logout</button>
                </div>
            </header>

            <main class="page-content">

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
          ‚îÄ‚îÄ SECTION: OVERVIEW
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <section class="dashboard-section" id="section-overview">
                    <div class="page-header">
                        <h2>Doctor Overview</h2>
                        <p>Practice summary and adherence at a glance. Click a patient to select them.</p>
                    </div>

                    <!-- Stats grid -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon stat-icon-blue">üë§</div>
                            <div class="stat-info">
                                <div class="stat-value" id="stat-patients">0</div>
                                <div class="stat-label">Total Patients</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon stat-icon-green">üíä</div>
                            <div class="stat-info">
                                <div class="stat-value" id="stat-meds-total">0</div>
                                <div class="stat-label">Active Prescriptions</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon stat-icon-orange">‚ö†Ô∏è</div>
                            <div class="stat-info">
                                <div class="stat-value" id="stat-poor">0</div>
                                <div class="stat-label">Poor Adherence</div>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon stat-icon-purple">üìä</div>
                            <div class="stat-info">
                                <div class="stat-value" id="stat-avg-adh">--%</div>
                                <div class="stat-label">Avg. Adherence</div>
                            </div>
                        </div>
                    </div>

                    <!-- Patient Roster preview -->
                    <div class="card-flat">
                        <div class="section-title">
                            <h3>Patient Roster</h3>
                            <button class="btn btn-primary btn-sm"
                                onclick="document.querySelector('[data-section=section-patients]').click()">
                                View All &rarr;
                            </button>
                        </div>
                        <div id="patient-list-preview">
                            <div class="empty-state">
                                <div class="empty-icon">üë§</div>
                                <p>Loading patients‚Ä¶</p>
                            </div>
                        </div>
                    </div>

                    <!-- Adherence board (global overview) -->
                    <div class="card-flat mt-16">
                        <div class="section-title">
                            <h3>Adherence Overview</h3>
                            <small style="color:var(--text-muted);font-size:0.78rem">Click a row for detailed
                                view</small>
                        </div>
                        <div id="adherence-board">
                            <div class="empty-state">
                                <div class="empty-icon">üìä</div>
                                <p>Loading‚Ä¶</p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
          ‚îÄ‚îÄ SECTION: MY PATIENTS  (with sub-tabs: List | Documents)
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <section class="dashboard-section" id="section-patients" style="display:none">
                    <div class="page-header">
                        <h2>My Patients</h2>
                        <p>Select a patient to unlock prescriptions, adherence monitoring, and documents.</p>
                    </div>

                    <!-- Sub-tab bar -->
                    <div class="section-subtabs" id="patients-subtabs">
                        <button class="section-subtab active" data-subtab="subtab-patient-list">
                            üë§ Patient List
                        </button>
                        <button class="section-subtab" data-subtab="subtab-documents">
                            üìÑ Documents
                        </button>
                    </div>

                    <!-- ‚îÄ‚îÄ Sub-tab: Patient List ‚îÄ‚îÄ -->
                    <div class="subtab-panel active" id="subtab-patient-list">
                        <div id="patient-list">
                            <div class="empty-state">
                                <div class="empty-icon">üë§</div>
                                <p>Loading patients‚Ä¶</p>
                            </div>
                        </div>
                    </div>

                    <!-- ‚îÄ‚îÄ Sub-tab: Documents ‚îÄ‚îÄ -->
                    <div class="subtab-panel" id="subtab-documents">

                        <!-- No patient selected banner -->
                        <div class="select-patient-prompt" id="docs-no-patient-banner">
                            <div class="prompt-icon">üìÑ</div>
                            <div>
                                <h3>Select a Patient First</h3>
                                <p>Switch to the <strong>Patient List</strong> tab and click on a patient row to load
                                    their documents.</p>
                            </div>
                        </div>

                        <!-- Patient-scoped content -->
                        <div id="docs-patient-content" style="display:none">
                            <div class="patient-scope-header">
                                <div class="scope-avatar">üìÑ</div>
                                <div class="scope-meta">
                                    <div class="scope-name">Documents for: <span id="docs-patient-name">‚Äî</span></div>
                                    <div class="scope-label">View-only ‚Äì doctors may read patient documents but cannot
                                        upload or delete them</div>
                                </div>
                                <!-- Upload intentionally removed: doctors have view-only document access -->
                            </div>

                            <!-- Document grid -->
                            <div class="doc-grid" id="docs-grid">
                                <div class="empty-state" style="grid-column:1/-1">
                                    <div class="empty-icon">üìÇ</div>
                                    <p>No documents yet.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
          ‚îÄ‚îÄ SECTION: PRESCRIPTIONS (patient-scoped)
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <section class="dashboard-section" id="section-prescriptions" style="display:none">
                    <div class="page-header">
                        <h2>Prescription Management</h2>
                        <p>Add, edit, or remove medications for a selected patient.</p>
                    </div>

                    <!-- No patient selected prompt -->
                    <div class="select-patient-prompt" id="rx-no-patient-banner">
                        <div class="prompt-icon">üíä</div>
                        <div>
                            <h3>Select a Patient First</h3>
                            <p>Go to <strong>My Patients</strong> and click a patient row, or use the <em>Prescribe</em>
                                button on a patient card.</p>
                        </div>
                    </div>

                    <!-- Patient-scoped prescription content -->
                    <div id="rx-patient-content" style="display:none">

                        <!-- Selected patient header -->
                        <div class="patient-scope-header">
                            <div class="scope-avatar">üë§</div>
                            <div class="scope-meta">
                                <div class="scope-name">Prescribing for: <span id="rx-selected-patient-name">‚Äî</span>
                                </div>
                                <div class="scope-label">All changes apply to this patient only</div>
                            </div>
                            <button class="btn btn-ghost btn-sm"
                                onclick="document.querySelector('[data-section=section-patients]').click()">
                                ‚Üê Change Patient
                            </button>
                        </div>

                        <!-- Current medications list for this patient -->
                        <div style="margin-bottom: 24px">
                            <h3 style="margin-bottom:14px">Current Medications</h3>
                            <div id="rx-current-meds">
                                <p style="color:var(--text-muted);font-size:0.85rem">Loading medications‚Ä¶</p>
                            </div>
                        </div>

                        <hr class="section-divider">

                        <!-- Add prescription form -->
                        <div class="form-panel">
                            <h3>‚ûï Add New Medication</h3>
                            <form id="rx-form" novalidate>
                                <input type="hidden" id="rx-patient-id">
                                <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px">
                                    <div class="form-group">
                                        <label class="form-label">Medication Name <span
                                                class="text-poor">*</span></label>
                                        <input id="rx-med-name" type="text" class="form-control"
                                            placeholder="e.g. Metformin" required>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">Dosage <span class="text-poor">*</span></label>
                                        <input id="rx-dosage" type="text" class="form-control" placeholder="e.g. 500mg"
                                            required>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Frequency <span class="text-poor">*</span></label>
                                    <select id="rx-frequency" class="form-control" required>
                                        <option value="">Select frequency‚Ä¶</option>
                                        <option value="Once daily">Once daily</option>
                                        <option value="Twice daily">Twice daily</option>
                                        <option value="Three times daily">Three times daily</option>
                                        <option value="Once at night">Once at night</option>
                                        <option value="As needed">As needed</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Clinical Notes (optional)</label>
                                    <input id="rx-note" type="text" class="form-control"
                                        placeholder="e.g. Take with food, avoid alcohol‚Ä¶">
                                </div>
                                <button type="submit" class="btn btn-primary">üíä Add Prescription</button>
                            </form>
                        </div>
                    </div>
                </section>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
          ‚îÄ‚îÄ SECTION: ADHERENCE MONITOR (patient-scoped)
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <section class="dashboard-section" id="section-adherence" style="display:none">
                    <div class="page-header">
                        <h2>Adherence Monitor</h2>
                        <p>Per-patient adherence breakdown, dose history, and 7-day trend.</p>
                    </div>

                    <!-- No patient selected prompt -->
                    <div class="select-patient-prompt" id="adh-no-patient-banner">
                        <div class="prompt-icon">üìä</div>
                        <div>
                            <h3>Select a Patient First</h3>
                            <p>Go to <strong>My Patients</strong> and click a patient row, or click <em>Adherence</em>
                                on a patient card to jump straight here.</p>
                        </div>
                    </div>

                    <!-- Patient-scoped adherence content -->
                    <div id="adh-patient-content" style="display:none">

                        <!-- Selected patient header -->
                        <div class="patient-scope-header">
                            <div class="scope-avatar">üìä</div>
                            <div class="scope-meta">
                                <div class="scope-name">Adherence for: <span id="adh-patient-name">‚Äî</span></div>
                                <div class="scope-label">Real-time medication adherence data</div>
                            </div>
                            <button class="btn btn-ghost btn-sm"
                                onclick="document.querySelector('[data-section=section-patients]').click()">
                                ‚Üê Change Patient
                            </button>
                        </div>

                        <!-- Overall adherence hero -->
                        <div class="card" style="margin-bottom:20px">
                            <div class="adh-overview">
                                <div>
                                    <div class="adh-big-num" id="adh-pct-value">--%</div>
                                    <div style="font-size:0.85rem;color:var(--text-muted);margin-top:4px">Overall
                                        Adherence Rate</div>
                                    <div style="margin-top:10px">
                                        <span id="adh-status-label" class="badge badge-primary">Calculating‚Ä¶</span>
                                    </div>
                                </div>
                                <div class="adh-details">
                                    <div style="margin-bottom:8px;font-size:0.85rem;color:var(--text-muted)">Adherence
                                        progress</div>
                                    <div class="progress-wrap" style="height:14px">
                                        <div class="progress-bar" id="adh-progress-bar" style="width:0%"></div>
                                    </div>
                                    <div style="display:flex;gap:20px;margin-top:16px;flex-wrap:wrap">
                                        <div style="text-align:center">
                                            <div style="font-size:0.72rem;color:var(--text-muted)">GOOD</div>
                                            <div style="font-weight:700;color:var(--good)">‚â• 80%</div>
                                        </div>
                                        <div style="text-align:center">
                                            <div style="font-size:0.72rem;color:var(--text-muted)">MODERATE</div>
                                            <div style="font-weight:700;color:var(--moderate)">60 ‚Äì 79%</div>
                                        </div>
                                        <div style="text-align:center">
                                            <div style="font-size:0.72rem;color:var(--text-muted)">POOR</div>
                                            <div style="font-weight:700;color:var(--poor)">&lt; 60%</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Per-medication breakdown -->
                        <div class="card" style="margin-bottom:20px">
                            <h3 style="margin-bottom:16px">Per-Medication Breakdown</h3>
                            <div id="adh-med-breakdown">
                                <p style="color:var(--text-muted);font-size:0.85rem">Loading‚Ä¶</p>
                            </div>
                        </div>

                        <!-- 7-day trend -->
                        <div class="card">
                            <h3 style="margin-bottom:6px">7-Day Adherence Trend</h3>
                            <p style="font-size:0.8rem;color:var(--text-muted);margin-bottom:16px">
                                Each cell = one day. Hover for details.
                            </p>
                            <div id="adh-weekly-trend"></div>
                            <div class="trend-legend">
                                <span><span class="trend-sample trend-taken"></span> Taken</span>
                                <span><span class="trend-sample trend-partial"></span> Partial</span>
                                <span><span class="trend-sample trend-missed"></span> Missed</span>
                                <span><span class="trend-sample trend-future"></span> Upcoming</span>
                                <span><span class="trend-sample trend-none"></span> No dose</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
          ‚îÄ‚îÄ SECTION: SCHEDULE APPOINTMENT
        ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <section class="dashboard-section" id="section-appointments" style="display:none">
                    <div class="page-header">
                        <h2>Schedule Appointment</h2>
                        <p>Book a new appointment for one of your patients.</p>
                    </div>
                    <div class="form-panel">
                        <h3>üìÖ New Appointment</h3>
                        <form id="appt-form" novalidate>
                            <div class="form-group">
                                <label class="form-label">Patient <span class="text-poor">*</span></label>
                                <select id="appt-patient" class="form-control">
                                    <option value="">Select patient‚Ä¶</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Date &amp; Time <span class="text-poor">*</span></label>
                                <input id="appt-datetime" type="datetime-local" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Reason / Notes <span class="text-poor">*</span></label>
                                <input id="appt-reason" type="text" class="form-control"
                                    placeholder="e.g. Routine Checkup" required>
                            </div>
                            <button type="submit" class="btn btn-primary">üìÖ Schedule Appointment</button>
                        </form>
                    </div>
                </section>

            </main>
        </div><!-- end .main-content -->
    </div><!-- end .dashboard-shell -->

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    MODALS
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->

    <!-- Edit Medication Modal -->
    <div class="modal-overlay" id="edit-med-modal">
        <div class="modal">
            <div class="modal-header">
                <h3>‚úèÔ∏è Edit Medication</h3>
                <button class="modal-close" onclick="closeModal('edit-med-modal')">‚úï</button>
            </div>
            <form id="edit-med-form" novalidate>
                <input type="hidden" id="edit-med-id">
                <div style="display:grid;grid-template-columns:1fr 1fr;gap:14px">
                    <div class="form-group">
                        <label class="form-label">Medication Name</label>
                        <input id="edit-med-name" type="text" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Dosage</label>
                        <input id="edit-med-dosage" type="text" class="form-control" required>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Frequency</label>
                    <select id="edit-med-frequency" class="form-control" required>
                        <option value="">Select‚Ä¶</option>
                        <option value="Once daily">Once daily</option>
                        <option value="Twice daily">Twice daily</option>
                        <option value="Three times daily">Three times daily</option>
                        <option value="Once at night">Once at night</option>
                        <option value="As needed">As needed</option>
                    </select>
                </div>
                <div style="display:flex;gap:10px">
                    <button type="submit" class="btn btn-primary flex-1">Save Changes</button>
                    <button type="button" class="btn btn-ghost" onclick="closeModal('edit-med-modal')">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Doc upload modal was intentionally removed. Doctors have view-only access to patient documents. -->

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    SCRIPTS
  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <script src="scripts/auth.js"></script>
    <script src="scripts/doctor.js"></script>
    <script>
        /**
         * Sub-tab logic inside the "My Patients" section.
         * Runs after both auth.js and doctor.js are loaded.
         */
        document.addEventListener('DOMContentLoaded', () => {

            /* ‚îÄ‚îÄ‚îÄ Sub-tabs (Patient List | Documents) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
            const subtabBtns = document.querySelectorAll('.section-subtab');
            const subtabPanels = document.querySelectorAll('.subtab-panel');

            subtabBtns.forEach(btn => {
                btn.addEventListener('click', function () {
                    subtabBtns.forEach(b => b.classList.remove('active'));
                    subtabPanels.forEach(p => p.classList.remove('active'));
                    this.classList.add('active');
                    const target = document.getElementById(this.dataset.subtab);
                    if (target) target.classList.add('active');
                });
            });

            /* ‚îÄ‚îÄ‚îÄ Reset seed data button (dev utility) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
            // Removes 'ah_seeded' flag so demo data re-seeds on next load
            window._resetSeed = () => {
                localStorage.removeItem('ah_seeded');
                localStorage.removeItem('ah_documents');
                console.log('[AfterHeal] Seed cleared ‚Äì reload to re-seed.');
            };
        });
    </script>
</body>

</html>